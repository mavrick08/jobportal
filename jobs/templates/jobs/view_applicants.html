{% extends 'accounts/base.html' %}
{% block content %}
    <div class="container mt-4">
        <h3 class="mb-4">Applicants for <strong>{{ job.title }}</strong></h3>

        {% if applications %}
            <table class="table table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Full Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Resume</th>
                        <th>Applied On</th>
                        <th>Status</th>
                    </tr>
                </thead>

                <tbody>
                    {% for app in applications %}
                        <tr>
                            <td>{{ app.student.full_name }}</td>
                            <td>{{ app.student.email }}</td>
                            <td>{{ app.student.phone }}</td>
                            <td>
                                {% if app.student.resume %}
                                    <a href="{{ app.student.resume.url }}" target="_blank">Download</a>
                                {% else %}
                                    Not Uploaded
                                {% endif %}
                            </td>

                            <td>{{ app.applied_at|date:"d M Y, H:i"}}</td>

                            <td>
                                <form method="POST" action="{% url 'update_application_status' app.id%}">
                                    {% csrf_token %}
                                    <select name="status" class="form-select form-select-sm">
                                        {% for value,label in status_choices %}
                                            <option value="{{ value }}" {% if value == app.status %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                    <button type="submit" class="btn btn-sm btn-outline-primary mt-1">Update</button>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}

                </tbody>
            </table>
        {% else %}
            <p>No applicants yet.</p>
        {% endif %}
    </div>
{% endblock %}